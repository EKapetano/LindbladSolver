This code was written for my personal research, but if someone wants to use or improve it, feel free.
